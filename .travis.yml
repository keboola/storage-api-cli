language: php
php:
- 5.4
sudo: false
before_script:
- curl -LSs http://box-project.github.io/box2/installer.php | php
- composer install --prefer-source --dev --no-interaction
script:
- php ./box.phar build
- php ./sapi-client.phar
after_success:
- CURRENT_TAG=`git describe --tags HEAD`
- echo $CURRENT_TAG
- mkdir builds
- cp ./sapi-client.phar ./builds/sapi-client.$CURRENT_TAG.phar
- cp ./sapi-client.phar ./builds/sapi-client.phar
deploy:
- provider: s3
  bucket: keboola-storage-api-cli
  local-dir: builds
  upload-dir: builds
  acl: public_read
  skip_cleanup: true
  detect_encoding: true
  access_key_id: $AWS_ACCESS_KEY
  secret_access_key: $AWS_SECRET_KEY